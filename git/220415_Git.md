# Git

### Undoing things

1. 파일 내용을 수정 전으로 되돌리기
   - git restore
     - `$ git restore 파일 이름.확장자`
     - modified된 파일을 이전으로 되돌리기
     - 새로운 파일로 덧붙이는것이기 때문에 수정사항은 없어짐, 다시 복원할 수 없음
2. 파일 상태를 Unstage로 되돌리기
   - git rm --cached  --  커밋 없을 때
     - `$ git rm --cached 파일이름.확장자`
     - 커밋이 없을 때
   - git restore --staged  --  커밋 있을 때
     - `$ git restore --staged 파일이름.확장자`
     - 커밋이 있을 때

3. 바로 직전 완료한 커밋 수정하기
   - git commit --amend
     - 상황별 기능
       1. 커밋 메시지만 수정
          - 마지막으로 커밋하고 나서 정한 것이 없을 때 (커밋하자마자 바로 이 명령을 실행하는 경우)
          - Vim 편집기가 열리면서 `i`를 입력하면 수정할 수 있게 됨
          - 해시값도 변경 된다.
       2. 이전 커밋 덮어 쓰기
          - Staging Area에 새로운 내용이 있을 때
     - 장점
       - `--amend` 옵션으로 커밋을 고치는 작업이 주는 장점은 마지막 커밋 작업에서 
         뭔가 빠뜨린 것을 넣거나 변경하는 것을 새 커밋으로 분리하지 않고 하나의 커밋에서 처리하는 것
       - 예를들면, “앗, 빠진 파일 넣었음”, “이전 커밋에서 오타 살짝 고침” 등의 커밋을 만들지 않겠다는 말
     - [중요]
       - 이렇게 --amend 옵션으로 커밋을 고치는 작업은, 추가로 작업한 일이 작다고 하더라도 
         이전의 커밋을 완전히 새로 고쳐서 새 커밋으로 변경하는 것을 의미함
       - 이전의 커밋은 일어나지 않은 일이 되는 것이고, 당연히 히스토리에도 남지 않음

---

### Reset & Revert

- 공통점

  - '과거로 되돌린다.'

- 차이점

  - '과거로 되돌리겠다는 내용도 기록되는가 (==commit 이력에 남는가)'

- git reset

  ```bash
  $ git reset [옵션] <커밋 ID>
  ```

  - **시계를 마치 과거로 돌리는 듯한 행위**로써, 특정 커밋 상태로 되돌아감
  - 특정 커밋으로 되돌아 갔을 때, 해당 커밋 이후로 쌓아 놨던 커밋들은 전부 사라짐
  - 옵션
    1. `--soft`
       - **돌아가려는 커밋으로 되돌아가고,**
       - 이후 commit된 파일들을 `staging area`로 돌려 놓음(commit 하기 전 상태)
       - 즉, 다시 커밋할 수 있는 상태가 됨
    2. `--mixed`
       - **돌아가려는 커밋으로 되돌아가고**,
       - 이후의 commit된 파일들을 `working directory`로 돌려놓음 (add 하기 전 상태)
       - 즉, unstage 된 상태로 남아있음
       - 기본 값
    3. `--hard`
       - **돌아가려는 커밋으로 되돌아가고**,
       - 이후의 commit된 파일들(`tracked 파일들`)은 모두 working directory에서 삭제
       - 단, Untracked 파일은 그대로 Untracked로 남음

- git revert

  ```bash
  $ git revert <커밋 ID>
  ```

  - **특정 사건을 없었던 일로 만드는 행위**로써, `이전 커밋을 취소한다는 새로운 커밋`을 만듦
  - `git reset`은 커밋 내역을 삭제하는 반면, `git revert`는 새로 커밋을 쌓는다는 차이
  - 히스토리가 유지됨
  - [중요] `git reset`과 비슷하다는 이유로 다음 사항이 혼동될 수 있음
    - `git reset --hard 5sd2f42`라고 작성하면 5sd2f42라는 커밋`으로` 돌아간다는 뜻
    - `git revert 5sd2f42`라고 작성하면 5sd2f42라는 커밋`을` 되돌린다는 뜻.
  - [참고사항]

  ```bash
  # 공백을 통해 여러 커밋을 한꺼번에 되돌리기 가능
  $ git revert 7f6c24c 006dc87 3551584
  
  # 범위 지정을 통해 여러 커밋을 한꺼번에 되돌리기 가능
  $ git revert 3551584..7f6c24c
  
  # 커밋 메시지 작성을 위한 편집기를 열지 않음 (자동으로 커밋 완료)
  $ git revert --no-edit 7f6c24c
  
  # 자동으로 커밋하지 않고, Staging Area에만 올림 (이후, git commit으로 수동 커밋)
  # 이 옵션은 여러 커밋을 revert 할 때 하나의 커밋으로 묶는게 가능
  $ git revert --no-commit 7f6c24c
  ```

  